<div class="modal-overlay" (click)="onOverlayClick($event)">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">{{ esEdicion ? 'Editar' : 'Agregar' }} Tarjeta</h3>
      <button class="modal-close" (click)="cancelar()">×</button>
    </div>
    
    <div class="modal-body">
      <form (ngSubmit)="guardar()" #tarjetaForm="ngForm">
        <div class="form-group">
          <label for="nombre" class="form-label">Nombre de la Tarjeta *</label>
          <input 
            type="text" 
            id="nombre" 
            name="nombre"
            [(ngModel)]="tarjeta.nombre" 
            class="form-input"
            placeholder="Ej: Visa Oro, Mastercard Gold"
            required
            #nombre="ngModel"
          />
          <div class="form-error" *ngIf="nombre.invalid && nombre.touched">
            El nombre es requerido
          </div>
        </div>
        
        <div class="form-group">
          <label for="banco" class="form-label">Banco</label>
          <input 
            type="text" 
            id="banco" 
            name="banco"
            [(ngModel)]="tarjeta.banco" 
            class="form-input"
            placeholder="Ej: Banco Santander, BBVA"
          />
        </div>
        
        <div class="form-group">
          <label for="limite" class="form-label">Límite de Crédito *</label>
          <input 
            type="number" 
            id="limite" 
            name="limite"
            [(ngModel)]="tarjeta.limite" 
            class="form-input"
            placeholder="0.00"
            min="0"
            step="0.01"
            required
            #limite="ngModel"
          />
          <div class="form-error" *ngIf="limite.invalid && limite.touched">
            El límite es requerido y debe ser mayor a 0
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="ultimosDigitos" class="form-label">Últimos 4 Dígitos</label>
            <input 
              type="text" 
              id="ultimosDigitos" 
              name="ultimosDigitos"
              [(ngModel)]="tarjeta.ultimosDigitos" 
              class="form-input"
              placeholder="1234"
              maxlength="4"
              pattern="[0-9]{4}"
            />
            <div class="form-error" *ngIf="tarjeta.ultimosDigitos && tarjeta.ultimosDigitos.length !== 4">
              Debe ser exactamente 4 dígitos
            </div>
          </div>
          
          <div class="form-group">
            <label for="diaCierre" class="form-label">Día de Cierre</label>
            <input 
              type="number" 
              id="diaCierre" 
              name="diaCierre"
              [(ngModel)]="tarjeta.diaCierre" 
              class="form-input"
              placeholder="15"
              min="1"
              max="31"
            />
          </div>
          
          <div class="form-group">
            <label for="diaVencimiento" class="form-label">Día de Vencimiento</label>
            <input 
              type="number" 
              id="diaVencimiento" 
              name="diaVencimiento"
              [(ngModel)]="tarjeta.diaVencimiento" 
              class="form-input"
              placeholder="20"
              min="1"
              max="31"
            />
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="btn btn-outline" (click)="cancelar()">
        Cancelar
      </button>
      <button 
        type="button" 
        class="btn btn-primary" 
        (click)="guardar()"
        [disabled]="tarjetaForm.invalid"
      >
        {{ esEdicion ? 'Actualizar' : 'Agregar' }}
      </button>
    </div>
  </div>
</div>

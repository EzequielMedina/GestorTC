<mat-card>
  <mat-card-header>
    <mat-card-title>Tarjetas de Crédito</mat-card-title>
    <button mat-raised-button color="primary" (click)="agregarTarjeta()" class="add-button">
      <mat-icon>add</mat-icon> <span>Agregar Tarjeta</span>
    </button>
  </mat-card-header>
  
  <mat-card-content>
    <div class="table-container">
      <!-- Mostrar spinner de carga -->
      <div *ngIf="loading" class="loading">
        <mat-spinner diameter="40"></mat-spinner>
      </div>

      <!-- Mostrar mensaje cuando no hay datos -->
      <div *ngIf="!loading && tarjetas.length === 0" class="no-data">
        <p>No hay tarjetas registradas. ¡Agrega tu primera tarjeta!</p>
      </div>

      <!-- Tabla de tarjetas -->
      <table *ngIf="!loading && tarjetas.length > 0" mat-table [dataSource]="tarjetas" class="mat-elevation-z1">
        <!-- Columna Nombre -->
        <ng-container matColumnDef="nombre">
          <th mat-header-cell *matHeaderCellDef> Nombre </th>
          <td mat-cell *matCellDef="let tarjeta"> {{tarjeta.nombre}} </td>
        </ng-container>

        <!-- Columna Banco -->
        <ng-container matColumnDef="banco">
          <th mat-header-cell *matHeaderCellDef> Banco </th>
          <td mat-cell *matCellDef="let tarjeta"> {{tarjeta.banco}} </td>
        </ng-container>

        <!-- Columna Últimos 4 Dígitos -->
        <ng-container matColumnDef="ultimosDigitos">
          <th mat-header-cell *matHeaderCellDef> Últimos 4 Dígitos </th>
          <td mat-cell *matCellDef="let tarjeta"> ****{{tarjeta.ultimosDigitos}} </td>
        </ng-container>

        <!-- Columna Vencimiento -->
        <ng-container matColumnDef="vencimiento">
          <th mat-header-cell *matHeaderCellDef> Vencimiento </th>
          <td mat-cell *matCellDef="let tarjeta"> {{tarjeta.diaVencimiento}}/mes </td>
        </ng-container>

        <!-- Columna Acciones -->
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef class="actions-header"> Acciones </th>
          <td mat-cell *matCellDef="let tarjeta" class="actions-cell">
            <button mat-icon-button color="primary" (click)="$event.stopPropagation(); editarTarjeta(tarjeta)" matTooltip="Editar">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="$event.stopPropagation(); eliminarTarjeta(tarjeta)" matTooltip="Eliminar">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnasMostradas"></tr>
        <tr mat-row *matRowDef="let row; columns: columnasMostradas;" (click)="editarTarjeta(row)"></tr>
      </table>
    </div>

    <!-- Paginador -->
    <mat-paginator *ngIf="!loading && tarjetas.length > 0"
      [length]="totalTarjetas"
      [pageSize]="pageSize"
      [pageIndex]="pageIndex"
      [pageSizeOptions]="[5, 10, 25, 100]"
      (page)="onPageChange($event)"
      aria-label="Seleccionar página">
    </mat-paginator>
  </mat-card-content>
</mat-card>
